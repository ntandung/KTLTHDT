USE [QLDSV]
GO
/****** Object:  StoredProcedure [dbo].[GHISV]    Script Date: 28/09/2019 1:37:08 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROC [dbo].[GHISV] 
@MASV NVARCHAR( 12), @HO NVARCHAR( 40), @TEN NVARCHAR(  12), @MALOP NVARCHAR(10), @PHAI NVARCHAR(6),
@NGAYSINH NVARCHAR(12) , @NOISINH NVARCHAR(40), @DIACHI NVARCHAR( 100)
AS
BEGIN
SET DATEFORMAT DMY 
MERGE INTO dbo.SINHVIEN   AS Target 
USING (SELECT MASV=@MASV  , HO=@HO , TEN=@TEN , MALOP=@MALOP , PHAI=@PHAI,
          NGAYSINH=@NGAYSINH  , NOISINH=@NOISINH , DIACHI=@DIACHI  ) AS Source
  ON Target.MASV= Source.MASV 
  WHEN MATCHED THEN 
    UPDATE SET TARGET.MASV =@MASV  ,
	       TARGET.HO=@HO  , 
		   TARGET.TEN=@TEN  , 
		   TARGET.MALOP =@MALOP , 
		   TARGET.PHAI=@PHAI , 
		   TARGET.NGAYSINH=@NGAYSINH  , 
		   TARGET.NOISINH=@NOISINH  , 
		   TARGET.DIACHI=@DIACHI 
  WHEN NOT MATCHED THEN
   INSERT (MASV  , HO , TEN , MALOP , PHAI , NGAYSINH , NOISINH , DIACHI)  
     VALUES (Source.MASV, Source.HO, Source.TEN, Source.MALOP,Source.PHAI, Source.NGAYSINH , Source.NOISINH,
	         Source.DIACHI ) ;

END

